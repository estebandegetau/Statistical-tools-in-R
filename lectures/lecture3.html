<!DOCTYPE html>
<html lang="es"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">
<meta name="author" content="Esteban Degetau">
<title>Regresión lineal</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
<link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Regresión lineal</h1>
  <p class="subtitle">Clase 3</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Esteban Degetau 
</div>
</div>
</div>

  <p class="date">2 de abril de 2025</p>
</section><section><section id="motivación" class="title-slide slide level1 center"><h1>Motivación</h1>

</section><section id="pregunta-de-investigación" class="slide level2"><h2>Pregunta de investigación</h2>
<p>Imaginemos que nos interesa estudiar la relación entre la escolaridad y el ingreso.</p>
<p>En particular, queremos estimar los rendimientos de un año adicional de escolaridad en los ingresos.</p>
</section><section id="datos" class="slide level2"><h2>Datos</h2>
<p>La Encuesta Nacional de Ingresos y Gastos de los Hogares (ENIGH) tiene información sobre los ingresos de los hogares y la escolaridad de los miembros de los hogares.</p>
<ul>
<li class="fragment"><p>Tomé a las personas que están en edad de trabajar en la ENIGH 2022: entre 18 y 65 años.</p></li>
<li class="fragment"><p>Sumé todos los ingresos que reportó cada persona.</p></li>
<li class="fragment"><p>Creé una tabla que se llama <code>poblacion</code> que contiene los ingresos, el nivel aprobado, la edad y el sexo de cada persona.</p></li>
<li class="fragment"><p>Adicionalmente, creé una variable que se llama <code>escolaridad</code> que contiene el número de años de escolaridad aprobados por cada persona.</p></li>
</ul></section></section><section><section id="exploración-de-los-datos" class="title-slide slide level1 center"><h1>Exploración de los datos</h1>

</section><section id="exploración-de-los-datos-1" class="slide level2"><h2>Exploración de los datos</h2>
<p>Antes de estimar cualquier modelo, es importante entender cómo se distribuyen los datos.</p>
<p>Una lista de preguntas para responder antes de estimar:</p>
<ul>
<li class="fragment"><p>¿Cómo se distribuyen las variables de interés?</p></li>
<li class="fragment"><p>¿Cómo trataremos la presencia de datos atípicos?</p></li>
<li class="fragment"><p>¿Qué otras variables pueden ser importantes para incluir en el modelo?</p></li>
</ul></section><section id="descripción-de-los-datos-por-nivel-aprobado" class="slide level2"><h2>Descripción de los datos por nivel aprobado</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb1-3"><a></a>        <span class="at">.by =</span> nivelaprob,</span>
<span id="cb1-4"><a></a>        <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb1-5"><a></a>        <span class="at">ingreso =</span> <span class="fu">mean</span>(ingreso, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-6"><a></a>        <span class="at">edad =</span> <span class="fu">mean</span>(edad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-7"><a></a>        <span class="at">poblacion =</span> <span class="fu">sum</span>(factor),</span>
<span id="cb1-8"><a></a>        <span class="at">mujeres =</span> <span class="fu">mean</span>(sexo <span class="sc">==</span> <span class="st">"Mujer"</span>)</span>
<span id="cb1-9"><a></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a></a>    <span class="fu">arrange</span>(nivelaprob) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="descripción-de-los-datos-por-nivel-aprobado-output" class="slide level2 output-location-slide"><h2>Descripción de los datos por nivel aprobado</h2><div class="cell output-location-slide">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   nivelaprob                      n ingreso  edad poblacion mujeres
   &lt;fct&gt;                       &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 Ninguno                      5650   4148.  49.2   2236391   0.576
 2 Preescolar                     70   3972.  33.7     20893   0.414
 3 Primaria                    38089   6265.  47.4  14830016   0.521
 4 Secundaria                  57612   7450.  39.0  22574676   0.533
 5 Preparatoria o bachillerato 43238   8554.  32.9  18935175   0.503
 6 Normal                       1114  13660.  46.0    446774   0.692
 7 Carrera técnica o comercial  5963  10435.  45.6   2825467   0.683
 8 Profesional                 35631  14010.  34.8  16981533   0.520
 9 Maestría                     2372  26496.  43.0   1268431   0.540
10 Doctorado                     506  30857.  45.7    302129   0.528</code></pre>
</div>
</div></section><section id="clase-factor" class="slide level2"><h2>Clase <code>factor</code>
</h2>
<p>Notemos que la variable <code>nivelaprob</code> tiene clase <code>factor</code>.</p>
<ul>
<li class="fragment"><p>Esta clase es útil para representar variables categóricas.</p></li>
<li class="fragment"><p>Asigna on orden a una serie de categorías, lo que facilita ordenar categorías por su nivel.</p></li>
<li class="fragment"><p>Por esto, <code>Ninguno</code> es menor que <code>Primaria</code>, que es menor que <code>Secundaria</code>, etc.</p></li>
<li class="fragment"><p>Una librería del tidyverse que facilita el trabajo de variables categóricas es <a href="https://forcats.tidyverse.org/"><code>forcats</code></a>.</p></li>
</ul>
<div class="fragment">
<p><img data-src="https://forcats.tidyverse.org/logo.png"></p>
</div>
</section><section id="distribución-de-nivel-aprobado" class="slide level2"><h2>Distribución de nivel aprobado</h2>
<p>El nivel aprobado determinará el número de años de escolaridad, que será nuestra variable independiente.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nivelaprob, <span class="at">y =</span> factor)) <span class="sc">+</span></span>
<span id="cb3-3"><a></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb3-4"><a></a>        <span class="fu">aes</span>(<span class="at">y =</span> factor),</span>
<span id="cb3-5"><a></a>        <span class="at">fun =</span> sum,</span>
<span id="cb3-6"><a></a>        <span class="at">geom =</span> <span class="st">"bar"</span>,</span>
<span id="cb3-7"><a></a>        <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb3-8"><a></a>        <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb3-9"><a></a>    ) <span class="sc">+</span></span>
<span id="cb3-10"><a></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb3-11"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb3-12"><a></a>        <span class="at">x =</span> <span class="st">"Nivel aprobado"</span>,</span>
<span id="cb3-13"><a></a>        <span class="at">y =</span> <span class="st">"Personas"</span>,</span>
<span id="cb3-14"><a></a>        <span class="at">title =</span> <span class="st">"Distribución de la población por nivel aprobado"</span>,</span>
<span id="cb3-15"><a></a>        <span class="at">subtitle =</span> <span class="st">"ENIGH 2022"</span></span>
<span id="cb3-16"><a></a>    ) <span class="sc">+</span></span>
<span id="cb3-17"><a></a>    <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</section><section id="distribución-de-nivel-aprobado-output" class="slide level2 output-location-slide"><h2>Distribución de nivel aprobado</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="distribución-del-ingreso" class="slide level2"><h2>Distribución del ingreso</h2>
<p>El ingreso será nuestra variable dependiente.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ingreso)) <span class="sc">+</span></span>
<span id="cb4-3"><a></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb4-4"><a></a>        <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb4-5"><a></a>        <span class="at">bins =</span> <span class="dv">50</span>,</span>
<span id="cb4-6"><a></a>        <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb4-7"><a></a>        <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb4-8"><a></a>    ) <span class="sc">+</span></span>
<span id="cb4-9"><a></a>    <span class="fu">geom_density</span>(</span>
<span id="cb4-10"><a></a>        <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb4-11"><a></a>        <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb4-12"><a></a>    ) <span class="sc">+</span></span>
<span id="cb4-13"><a></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb4-14"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb4-15"><a></a>        <span class="at">x =</span> <span class="st">"Ingreso mensual (escala logarítmica)"</span>,</span>
<span id="cb4-16"><a></a>        <span class="at">y =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb4-17"><a></a>        <span class="at">title =</span> <span class="st">"Distribución de los ingresos"</span>,</span>
<span id="cb4-18"><a></a>        <span class="at">subtitle =</span> <span class="st">"ENIGH 2022"</span></span>
<span id="cb4-19"><a></a>    ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</section><section id="distribución-del-ingreso-output" class="slide level2 output-location-slide"><h2>Distribución del ingreso</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="distribución-del-ingreso-después-de-truncar" class="slide level2"><h2>Distribución del ingreso después de truncar</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>poblacion <span class="ot">&lt;-</span> poblacion <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a></a>    <span class="fu">filter</span>(</span>
<span id="cb5-3"><a></a>        ingreso <span class="sc">&lt;</span> <span class="fu">quantile</span>(ingreso, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-4"><a></a>        ingreso <span class="sc">&gt;</span> <span class="fu">quantile</span>(ingreso, <span class="fl">0.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-5"><a></a>    )</span>
<span id="cb5-6"><a></a></span>
<span id="cb5-7"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ingreso)) <span class="sc">+</span></span>
<span id="cb5-9"><a></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb5-10"><a></a>        <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb5-11"><a></a>        <span class="at">bins =</span> <span class="dv">50</span>,</span>
<span id="cb5-12"><a></a>        <span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb5-13"><a></a>        <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb5-14"><a></a>    ) <span class="sc">+</span></span>
<span id="cb5-15"><a></a>    <span class="fu">geom_density</span>(</span>
<span id="cb5-16"><a></a>        <span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb5-17"><a></a>        <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb5-18"><a></a>    ) <span class="sc">+</span></span>
<span id="cb5-19"><a></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb5-20"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb5-21"><a></a>        <span class="at">x =</span> <span class="st">"Ingreso mensual (escala logarítmica)"</span>,</span>
<span id="cb5-22"><a></a>        <span class="at">y =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb5-23"><a></a>        <span class="at">title =</span> <span class="st">"Distribución de los ingresos"</span>,</span>
<span id="cb5-24"><a></a>        <span class="at">subtitle =</span> <span class="st">"ENIGH 2022, truncado al 1% superior e inferior"</span></span>
<span id="cb5-25"><a></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="distribución-del-ingreso-después-de-truncar-output" class="slide level2 output-location-slide"><h2>Distribución del ingreso después de truncar</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="ingreso-promedio-por-nivel-aprobado" class="slide level2"><h2>Ingreso promedio por nivel aprobado</h2>
<p>Una manera de aproximarnos a la relación entre escolaridad e ingreso es calcular el ingreso promedio por nivel aprobado.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>niveles <span class="ot">&lt;-</span> poblacion <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a></a>    <span class="fu">group_by</span>(nivelaprob) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb6-4"><a></a>        <span class="at">ingreso_prom =</span> <span class="fu">weighted.mean</span>(<span class="at">x =</span> ingreso,<span class="at">w =</span> factor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-5"><a></a>        <span class="at">sd =</span> <span class="fu">sd</span>(ingreso, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-6"><a></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb6-7"><a></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-9"><a></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-10"><a></a>        <span class="at">lower =</span> ingreso_prom <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb6-11"><a></a>        <span class="at">upper =</span> ingreso_prom <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb6-12"><a></a>    ) </span>
<span id="cb6-13"><a></a>    </span>
<span id="cb6-14"><a></a>niveles</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   nivelaprob                  ingreso_prom     sd     n  lower  upper
   &lt;fct&gt;                              &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Ninguno                            3830.  4063.  4059  3705.  3955.
 2 Preescolar                         4153.  3129.    53  3311.  4995.
 3 Primaria                           5653.  5329. 29975  5593.  5713.
 4 Secundaria                         6973.  5833. 46034  6920.  7026.
 5 Preparatoria o bachillerato        8026.  6765. 34270  7954.  8097.
 6 Normal                            13021.  8456.   994 12496. 13547.
 7 Carrera técnica o comercial        9541.  7709.  4745  9322.  9760.
 8 Profesional                       12349.  9272. 28685 12241. 12456.
 9 Maestría                          19768. 11131.  2053 19287. 20250.
10 Doctorado                         22276. 11789.   427 21158. 23394.</code></pre>
</div>
</div>
</div>
</section><section id="ingreso-promedio-por-nivel-aprobado-1" class="slide level2"><h2>Ingreso promedio por nivel aprobado</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>niveles <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nivelaprob, <span class="at">y =</span> ingreso_prom)) <span class="sc">+</span></span>
<span id="cb8-3"><a></a>    <span class="fu">geom_pointrange</span>(</span>
<span id="cb8-4"><a></a>        <span class="fu">aes</span>(</span>
<span id="cb8-5"><a></a>            <span class="at">ymin =</span> lower,</span>
<span id="cb8-6"><a></a>            <span class="at">ymax =</span> upper</span>
<span id="cb8-7"><a></a>        )</span>
<span id="cb8-8"><a></a>    ) <span class="sc">+</span></span>
<span id="cb8-9"><a></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb8-10"><a></a>        <span class="at">labels =</span> scales<span class="sc">::</span>dollar,</span>
<span id="cb8-11"><a></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">40000</span>, <span class="dv">5000</span>)</span>
<span id="cb8-12"><a></a>    ) <span class="sc">+</span></span>
<span id="cb8-13"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb8-14"><a></a>        <span class="at">x =</span> <span class="st">"Nivel aprobado"</span>,</span>
<span id="cb8-15"><a></a>        <span class="at">y =</span> <span class="st">"Ingreso promedio"</span>,</span>
<span id="cb8-16"><a></a>        <span class="at">title =</span> <span class="st">"Ingreso promedio por nivel aprobado"</span>,</span>
<span id="cb8-17"><a></a>        <span class="at">subtitle =</span> <span class="st">"Intervalos de confianza del 95%"</span></span>
<span id="cb8-18"><a></a>    ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="ingreso-promedio-por-nivel-aprobado-1-output" class="slide level2 output-location-slide"><h2>Ingreso promedio por nivel aprobado</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-8-1.png" width="1152"></p>
</figure>
</div>
</div>
</div></section><section id="distribución-del-ingreso-por-nivel-aprobado-y-sexo" class="slide level2"><h2>Distribución del ingreso por nivel aprobado y sexo</h2>
<p>A pesar de que los promedios son muy informativos, esconden la distribución de los datos.</p>
<div class="fragment">
<p>Adicionalmente, queremos preguntarnos si el ingreso es diferente para hombres y mujeres, <strong>para cada nivel aprobado</strong>.</p>
</div>
<div class="fragment">
<p>El diagrama de caja y brazo (boxplot) visualiza la distribución de los datos mostrando:</p>
<ul>
<li class="fragment"><p>La mediana (línea negra),</p></li>
<li class="fragment"><p>El rango intercuartílico (IQR) (caja): el conjunto de valores centrales que acumulan el 50% de los datos.</p></li>
<li class="fragment"><p>Los brazos, que son los valores que están dentro de 1.5 veces el IQR.</p></li>
<li class="fragment"><p>Los puntos que están fuera de los brazos son considerados <em>outliers</em>.</p></li>
</ul>
</div>
</section><section id="distribución-del-ingreso-por-nivel-aprobado-y-sexo-1" class="slide level2"><h2>Distribución del ingreso por nivel aprobado y sexo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a></a>    <span class="fu">ggplot</span>(</span>
<span id="cb9-3"><a></a>        <span class="fu">aes</span>(</span>
<span id="cb9-4"><a></a>            <span class="at">x =</span> nivelaprob, </span>
<span id="cb9-5"><a></a>            <span class="at">y =</span> ingreso, </span>
<span id="cb9-6"><a></a>            <span class="at">fill =</span> sexo</span>
<span id="cb9-7"><a></a>            )) <span class="sc">+</span></span>
<span id="cb9-8"><a></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb9-10"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb9-11"><a></a>        <span class="at">x =</span> <span class="st">"Nivel aprobado"</span>,</span>
<span id="cb9-12"><a></a>        <span class="at">y =</span> <span class="st">"Ingreso mensual (escala logarítmica)"</span>,</span>
<span id="cb9-13"><a></a>        <span class="at">title =</span> <span class="st">"Distribución del ingreso por nivel aprobado y sexo"</span>,</span>
<span id="cb9-14"><a></a>        <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb9-15"><a></a>    ) <span class="sc">+</span></span>
<span id="cb9-16"><a></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="distribución-del-ingreso-por-nivel-aprobado-y-sexo-1-output" class="slide level2 output-location-slide"><h2>Distribución del ingreso por nivel aprobado y sexo</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-9-1.png" width="1152"></p>
</figure>
</div>
</div>
</div></section><section id="escolaridad-y-edad" class="slide level2"><h2>Escolaridad y edad</h2>
<p>Otra variable que puede ser importante para el ingreso es la edad:</p>
<ul>
<li class="fragment"><p>Puede estar correlacionada con escolaridad, porque las personas más viejas han tenido más tiempo para estudiar.</p></li>
<li class="fragment"><p>También puede estar correlacionada con el ingreso, porque las personas más viejas tienen más experiencia y más apego al mercado laboral.</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nivelaprob, <span class="at">y =</span> edad)) <span class="sc">+</span></span>
<span id="cb10-3"><a></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb10-6"><a></a>        <span class="at">x =</span> <span class="st">"Nivel aprobado"</span>,</span>
<span id="cb10-7"><a></a>        <span class="at">y =</span> <span class="st">"Edad"</span>,</span>
<span id="cb10-8"><a></a>        <span class="at">title =</span> <span class="st">"Distribución de la edad por nivel aprobado"</span></span>
<span id="cb10-9"><a></a>    ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</section><section id="escolaridad-y-edad-output" class="slide level2 output-location-slide"><h2>Escolaridad y edad</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="imputación-de-años-de-escolaridad-según-el-nivel-aprobado" class="slide level2"><h2>Imputación de años de escolaridad según el nivel aprobado</h2>
<p>La ENIGH incluye el nivel y el grado de estudios aprobados, reportados por cada persona.</p>
<div class="fragment">
<p>Pero no incluye los años de escolaridad.</p>
</div>
<div class="fragment">
<p>Creé la variable <code>escolaridad</code> a partir de la variable <code>nivelaprob</code> y <code>gradoaprob</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-11-1.png" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="relación-no-paramétrica-entre-escolaridad-e-ingreso" class="slide level2"><h2>Relación no paramétrica entre escolaridad e ingreso</h2>
<p>Decimos que estimamos un modelo <em>no paramétrico</em> cuando le permitimos al modelo que se ajuste a los datos sin imponerle una forma funcional.</p>
<div class="fragment">
<p>La función <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">ggplot2::geom_smooth()</a></code> ajusta un modelo no paramétrico a los datos, de la siguiente manera:</p>
<p><span class="math display">\[
Y_i = f(X_i) + \epsilon_i
\]</span></p>
<p>donde:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(Y_i\)</span> es el variable dependiente: el ingreso de la persona <span class="math inline">\(i\)</span>,</p></li>
<li class="fragment"><p><span class="math inline">\(X_i\)</span> es el variable independiente: la escolaridad de la persona <span class="math inline">\(i\)</span>, y</p></li>
<li class="fragment"><p><span class="math inline">\(f(\cdot)\)</span> es una función que se <em>ajusta</em> a los datos.</p></li>
<li class="fragment"><p><span class="math inline">\(\epsilon_i\)</span> es el error de estimación de la persona <span class="math inline">\(i\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<p>Dependiendo de las características de los datos, <code>geom_smooth()</code> ajusta diferentes tipos de modelos no paramétricos.</p>
</div>
</section><section id="relación-no-paramétrica-entre-escolaridad-e-ingreso-1" class="slide level2"><h2>Relación no paramétrica entre escolaridad e ingreso</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>poblacion <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> escolaridad, <span class="at">y =</span> ingreso)) <span class="sc">+</span></span>
<span id="cb11-3"><a></a>    <span class="fu">stat_summary</span>() <span class="sc">+</span> <span class="co"># Promedio y IC</span></span>
<span id="cb11-4"><a></a>    <span class="fu">geom_smooth</span>() <span class="sc">+</span>  <span class="co"># Ajuste no paramétrico</span></span>
<span id="cb11-5"><a></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb11-6"><a></a>    <span class="fu">labs</span>(</span>
<span id="cb11-7"><a></a>        <span class="at">x =</span> <span class="st">"Escolaridad"</span>,</span>
<span id="cb11-8"><a></a>        <span class="at">y =</span> <span class="st">"Ingreso mensual"</span>,</span>
<span id="cb11-9"><a></a>        <span class="at">title =</span> <span class="st">"Relación entre escolaridad e ingreso"</span>,</span>
<span id="cb11-10"><a></a>        <span class="at">subtitle =</span> <span class="st">"Tamaño de los puntos proporcional al número de personas"</span></span>
<span id="cb11-11"><a></a>    ) <span class="sc">+</span></span>
<span id="cb11-12"><a></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb11-13"><a></a>    <span class="fu">scale_size_continuous</span>(</span>
<span id="cb11-14"><a></a>        <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb11-15"><a></a>        <span class="at">labels =</span> scales<span class="sc">::</span>comma,</span>
<span id="cb11-16"><a></a>        <span class="at">name =</span> <span class="st">"Personas"</span></span>
<span id="cb11-17"><a></a>    ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="relación-no-paramétrica-entre-escolaridad-e-ingreso-1-output" class="slide level2 output-location-slide"><h2>Relación no paramétrica entre escolaridad e ingreso</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="conclusiones-de-la-exploración" class="slide level2 scrollable"><h2>Conclusiones de la exploración</h2>
<ol type="1">
<li class="fragment"><p>Las personas que reportan un nivel aprobado más alto tienen salarios más altos en promedio.</p></li>
<li class="fragment"><p>Las mujeres reportaron ingresos, dado que tienen el mismo nivel aprobado, en todos los niveles aprobados.</p></li>
<li class="fragment"><p>La distribución de la edad es diferente para cada nivel aprobado. Las personas sin escolaridad som más viejas.</p></li>
<li class="fragment">
<p>No hay una manera perfecta de imputar la escolaridad, pero podemos ver que se acumulan datos en el último grado de cada nivel aprobado, lo que sugiere que esas personas completaron el nivel.</p>
<ul>
<li class="fragment">Esto puede ser importante para la estimación de los rendimientos de la escolaridad: puede ser que aprobar el último grado de un nivel tenga un efecto más grande que aprobar el primer grado de un nivel.</li>
</ul>
</li>
<li class="fragment"><p>La imputación de escolaridad parece reflejar correctamente la relación entre escolaridad e ingreso.</p></li>
</ol></section></section><section><section id="modelo-de-regresión-lineal" class="title-slide slide level1 center"><h1>Modelo de regresión lineal</h1>

</section><section id="modelo-de-regresión-lineal-1" class="slide level2"><h2>Modelo de regresión lineal</h2>
<p>Ya sabemos bien cuál es el ingreso promedio por año de escolaridad.</p>
<div class="fragment">
<p>Sin embargo, todavía nos falta estimar cuánto aumenta el ingreso por cada año adicional de escolaridad: <strong>el rendimiento de la escolaridad</strong>.</p>
</div>
</section><section id="simulación-de-un-modelo-de-regresión-lineal" class="slide level2"><h2>Simulación de un modelo de regresión lineal</h2>
<p>Imaginemos un mundo en el que el ingreso <strong>solo</strong> depende de la escolaridad.</p>
<div class="fragment">
<p>En este mundo, el ingreso se determina como función de la escolaridad de la siguiente manera:</p>
<p><span class="math display">\[
Y_i = 1000 + 200 X_i + \epsilon_i
\]</span></p>
</div>
<div class="fragment">
<p>donde:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(Y_i\)</span> es el ingreso de la persona <span class="math inline">\(i\)</span>,</p></li>
<li class="fragment"><p><span class="math inline">\(X_i\)</span> es la escolaridad de la persona <span class="math inline">\(i\)</span>,</p></li>
<li class="fragment"><p><span class="math inline">\(\epsilon_i\)</span> es el error de estimación de la persona <span class="math inline">\(i\)</span>, distribuido <span class="math inline">\(N(\mu = 0, \sigma = 1,000)\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<p>Una persona sin educación (<span class="math inline">\(X_i=0\)</span>) en promedio tendrá <span class="math inline">\(1,000\)</span>.</p>
</div>
<div class="fragment">
<p>Después, por cada año adicional de escolaridad, el ingreso aumentará en promedio <span class="math inline">\(200\)</span>.</p>
</div>
<div class="fragment">
<p>Pero, como hay un error de estimación, no todas las personas con la misma escolaridad tendrán el mismo ingreso.</p>
</div>
</section><section id="simulación-de-un-modelo-de-regresión-lineal-1" class="slide level2"><h2>Simulación de un modelo de regresión lineal</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-2"><a></a></span>
<span id="cb12-3"><a></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-4"><a></a></span>
<span id="cb12-5"><a></a>ingresos_simulados <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-6"><a></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb12-7"><a></a>    <span class="at">escolaridad =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">25</span>),</span>
<span id="cb12-8"><a></a>    <span class="at">ingreso =</span> <span class="dv">1000</span> <span class="sc">+</span> (<span class="dv">200</span> <span class="sc">*</span> escolaridad) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb12-9"><a></a>) </span>
<span id="cb12-10"><a></a></span>
<span id="cb12-11"><a></a>ingresos_simulados <span class="sc">|&gt;</span></span>
<span id="cb12-12"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> escolaridad, <span class="at">y =</span> ingreso)) <span class="sc">+</span></span>
<span id="cb12-13"><a></a>    <span class="fu">geom_point</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="simulación-de-un-modelo-de-regresión-lineal-1-output" class="slide level2 output-location-slide"><h2>Simulación de un modelo de regresión lineal</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="modelo-de-regresión-lineal-2" class="slide level2"><h2>Modelo de regresión lineal</h2>
<p>Ahora, si no conociéramos el proceso de generación de datos, podríamos preguntarnos cuál es el rendimiento de la educación es este mundo.</p>
<div class="fragment">
<p>Podemos estimar un modelo de regresión lineal, descrito con la siguiente ecuación:</p>
<p><span class="math display">\[
y_i=\beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
</div>
<div class="fragment">
<p>donde:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(\beta_0\)</span> es el intercepto del modelo, que representa el ingreso promedio de una persona sin escolaridad (<span class="math inline">\(X_i=0\)</span>).</p></li>
<li class="fragment"><p><span class="math inline">\(\beta_1\)</span> es la pendiente del modelo, que representa el rendimiento de la escolaridad: el cambio en el ingreso por cada año adicional de escolaridad.</p></li>
<li class="fragment"><p><span class="math inline">\(\epsilon_i\)</span> es el error de estimación de la persona <span class="math inline">\(i\)</span>, que representa la diferencia entre su ingreso real y el ingreso estimado por el modelo. Asumimos que <span class="math inline">\(\epsilon_i\)</span> es distribuido <span class="math inline">\(N(\mu = 0, \sigma^2)\)</span>.</p></li>
</ul>
</div>
<div class="fragment">
<p>Vamos a buscar los valores de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> que mejor se ajusten a los datos.</p>
</div>
</section><section id="estimación-del-modelo" class="slide level2"><h2>Estimación del modelo</h2>
<div id="exm-wrong" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 1</strong></span> Imaginemos que una persona <em>tomadora de decisiones</em> nos propone que:</p>
<p><span class="math display">\[
\beta_0=0; \quad \beta_1=300
\]</span></p>
</div>
<p>Podemos calcular el <em>ingreso estimado</em> <span class="math inline">\(\hat y_i\)</span> de cada persona y el <em>error de estimación</em> <span class="math inline">\(\hat \epsilon_i\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>ingresos_simulados <span class="ot">&lt;-</span> ingresos_simulados <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a></a>    <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a></a>        <span class="at">y_hat_1 =</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">300</span> <span class="sc">*</span> escolaridad),</span>
<span id="cb13-4"><a></a>        <span class="at">error_1 =</span> ingreso <span class="sc">-</span> y_hat_1</span>
<span id="cb13-5"><a></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="estimación-del-modelo-output" class="slide level2 output-location-slide"><h2>Estimación del modelo</h2><div class="cell output-location-slide">

</div></section><section id="estimación-del-modelo-1" class="slide level2"><h2>Estimación del modelo</h2>

<img data-src="lecture3_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section><section id="bondad-de-ajuste" class="slide level2"><h2>Bondad de ajuste</h2>
<p>¿Qué tan bien se ajusta el modelo a los datos observados?</p>
<ul>
<li class="fragment"><p>Hay muchas métricas para evaluar el ajuste de un modelo de regresión lineal.</p></li>
<li class="fragment"><p>Una métrica común es la raíz cuadrada del error cuadrático medio (RMSE por sus siglas en inglés):</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^n \hat \epsilon_i^2}
\]</span></p>
<p>Elevamos al cuadrado el error para penalizar los errores negativos y positivos, y penalizar más a los errores grandes.</p>
</div>
<div class="fragment">
<p>Sacamos raíz cuadrada para que la métrica esté en la misma escala que la variable dependiente.</p>
</div>
</section><section id="rmse" class="slide level2"><h2>RMSE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>ingresos_simulados <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb14-3"><a></a>        <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(error_1<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb14-4"><a></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
   rmse
  &lt;dbl&gt;
1 1247.</code></pre>
</div>
</div>
<div class="fragment">
<p>En promedio, el modelo planteado por la persona tomadora de decisiones tiene un error de estimación de <span class="math inline">\(1,244\)</span>.</p>
</div>
<div class="fragment">
<p>Este error es mayor a la desviación estándar de los ingresos, que es <span class="math inline">\(1,000\)</span>.</p>
</div>
</section><section id="estimación-por-mínimos-cuadrados" class="slide level2"><h2>Estimación por mínimos cuadrados</h2>
<p>Mínimos cuadrados ordinarios (MCO) es un método común para estimar los parámetros de un modelo de regresión lineal.</p>
<div class="fragment">
<p>Lo que hace es <strong>minimizar</strong> la suma de los cuadrados de los errores de estimación.</p>
</div>
<div class="fragment">
<p>Podríamos hacer la derivación de la función de error y encontrar los valores de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> que minimizan la suma de los cuadrados.</p>
</div>
<div class="fragment">
<p>Pero no lo haremos aquí, porque R lo hace por nosotros.</p>
</div>
</section><section id="estimación-del-modelo-2" class="slide level2"><h2>Estimación del modelo</h2>
<p>La función base para estimar regresiones por MCO es <code><a href="https://rdrr.io/r/stats/lm.html">stats::lm()</a></code>.</p>
<div class="fragment">
<p>El lenguaje para describirle a R el modelo que queremos estimar es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>model_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
<div class="fragment">
<p>En nuestro caso, el modelo es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>ingresos_sim_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> ingresos_simulados)</span>
<span id="cb17-2"><a></a></span>
<span id="cb17-3"><a></a><span class="fu">summary</span>(ingresos_sim_fit)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ingreso ~ escolaridad, data = ingresos_simulados)

Residuals:
     Min       1Q   Median       3Q      Max 
-2919.33  -629.56    10.84   638.19  2731.78 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1044.491     60.275   17.33   &lt;2e-16 ***
escolaridad  195.571      4.122   47.44   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 948.6 on 998 degrees of freedom
Multiple R-squared:  0.6928,    Adjusted R-squared:  0.6925 
F-statistic:  2251 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</section><section id="estimación-del-modelo-2-output" class="slide level2 output-location-slide"><h2>Estimación del modelo</h2><div class="cell output-location-slide">

</div></section><section id="visualización-del-modelo-mco" class="slide level2"><h2>Visualización del modelo MCO</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>ingresos_simulados <span class="ot">&lt;-</span> ingresos_simulados <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-3"><a></a>        <span class="at">y_hat_2 =</span> <span class="fu">fitted</span>(ingresos_sim_fit), <span class="co"># Saca los valores ajustados</span></span>
<span id="cb19-4"><a></a>        <span class="at">error_2 =</span> <span class="fu">residuals</span>(ingresos_sim_fit) </span>
<span id="cb19-5"><a></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<img data-src="lecture3_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section><section id="visualización-del-modelo-mco-output" class="slide level2 output-location-slide"><h2>Visualización del modelo MCO</h2><div class="cell output-location-slide">

</div></section><section id="comparación-de-los-modelos" class="slide level2"><h2>Comparación de los modelos</h2>

<img data-src="lecture3_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section><section id="comparación-de-los-modelos-1" class="slide level2"><h2>Comparación de los modelos</h2>
<p>Una vez que tenemos los dos modelos, podemos comparar el error de estimación de cada uno.</p>
<div class="fragment">
<div class="cell" data-df-print="kable">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>ingresos_simulados <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb20-3"><a></a>        <span class="at">rmse_1 =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(error_1<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb20-4"><a></a>        <span class="at">rmse_2 =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(error_2<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-5"><a></a>    )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-df-print="kable">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  rmse_1 rmse_2
   &lt;dbl&gt;  &lt;dbl&gt;
1  1247.   948.</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>El modelo estimado con MCO tiene un RMSE más bajo que el modelo propuesto, porque MCO encuentra la línea que minimiza el error de estimación.</p>
</div>
</section></section><section><section id="volviendo-a-la-vida-real" class="title-slide slide level1 center"><h1>Volviendo a la vida real</h1>

</section><section id="rendimientos-de-la-escolaridad" class="slide level2"><h2>Rendimientos de la escolaridad</h2>
<p>Para modelos lineales, la función <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code> tiene mejor rendimiento que <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, además de que es más fácil presentar resultados usando <code><a href="https://lrberge.github.io/fixest/reference/etable.html">fixest::etable()</a></code>.</p>
<div class="fragment">
<p><code>feols()</code> guarda la misma sintaxis que <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(fixest)</span>
<span id="cb22-2"><a></a></span>
<span id="cb22-3"><a></a>ingresos_fit <span class="ot">&lt;-</span> <span class="fu">feols</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> ingresos_simulados)</span>
<span id="cb22-4"><a></a>poblacion_fit <span class="ot">&lt;-</span> <span class="fu">feols</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> poblacion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</div>
</section><section id="rendimientos-de-la-escolaridad-output" class="slide level2 output-location-slide"><h2>Rendimientos de la escolaridad</h2><div class="cell output-location-slide">

</div></section><section id="rendimientos-de-la-escolaridad-1" class="slide level2"><h2>Rendimientos de la escolaridad</h2>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a></a><span class="in">```{r}</span></span>
<span id="cb23-2"><a></a><span class="in">#| label: fig-ols</span></span>
<span id="cb23-3"><a></a><span class="in">#| results: asis</span></span>
<span id="cb23-4"><a></a></span>
<span id="cb23-5"><a></a><span class="in">etable(</span></span>
<span id="cb23-6"><a></a><span class="in">    ingresos_fit,</span></span>
<span id="cb23-7"><a></a><span class="in">    poblacion_fit,</span></span>
<span id="cb23-8"><a></a><span class="in">    title = "Modelo de regresión lineal",</span></span>
<span id="cb23-9"><a></a><span class="in">    fitstat = ~ n + r2 + my + f,</span></span>
<span id="cb23-10"><a></a><span class="in">    markdown = T</span></span>
<span id="cb23-11"><a></a><span class="in">)</span></span>
<span id="cb23-12"><a></a><span class="in">```</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="etable">
<img src="./images/etable/etable_tex_2025-04-08_1400648435.png">
</div>
<div class="fragment">
<ul>
<li class="fragment"><p>En promedio, un año adicional de escolaridad está relacionado con un ingreso adicional de $571 pesos al mes.</p></li>
<li class="fragment"><p>En promedio, una persona sin escolaridad tiene un ingreso mensual de $1,364.</p></li>
<li class="fragment">
<p><span class="math inline">\(R^2\)</span> es una métrica de bondad de ajuste que mide la proporción de la varianza de la variable dependiente que es explicada por el modelo.</p>
<ul>
<li class="fragment"><p>La escolaridad explica el 12% de la variación del ingreso en la población, mientras que el modelo simulado explica el 70% de la variación del ingreso.</p></li>
<li class="fragment"><p>Esto es esperado, porque definimos el modelo simulado de tal manera que la escolaridad es la única variable que afecta el ingreso.</p></li>
</ul>
</li>
</ul>
</div>
</section></section><section><section id="inferencia-para-coeficientes" class="title-slide slide level1 center"><h1>Inferencia para coeficientes</h1>

</section><section id="variabilidad-en-los-estimadores" class="slide level2"><h2>Variabilidad en los estimadores</h2>
<p>Estudiaremos la variabilidad de los estimadores de los coeficientes del modelo MCO en el mundo simulado que tenemos.</p>
<div class="fragment">
<p>Imaginemos que tomamos métricas de escolaridad y de ingresos en una muestra aleatoria diferente, pero que comparte las características de la población simulada original.</p>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>ingresos_simulados_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-2"><a></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb24-3"><a></a>    <span class="at">escolaridad =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">25</span>),</span>
<span id="cb24-4"><a></a>    <span class="at">ingreso =</span> <span class="dv">1000</span> <span class="sc">+</span> (<span class="dv">200</span> <span class="sc">*</span> escolaridad) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb24-5"><a></a>) </span>
<span id="cb24-6"><a></a></span>
<span id="cb24-7"><a></a>ingresos_sim_fit <span class="ot">&lt;-</span> <span class="fu">feols</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> ingresos_simulados)</span>
<span id="cb24-8"><a></a>ingresos_sim_fit_2 <span class="ot">&lt;-</span> <span class="fu">feols</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> ingresos_simulados_2)</span>
<span id="cb24-9"><a></a></span>
<span id="cb24-10"><a></a><span class="fu">etable</span>(</span>
<span id="cb24-11"><a></a>    ingresos_sim_fit,</span>
<span id="cb24-12"><a></a>    ingresos_sim_fit_2,</span>
<span id="cb24-13"><a></a>    <span class="at">title =</span> <span class="st">"Modelo de regresión lineal"</span>,</span>
<span id="cb24-14"><a></a>    <span class="at">fitstat =</span> <span class="sc">~</span> n <span class="sc">+</span> r2 <span class="sc">+</span> my <span class="sc">+</span> f,</span>
<span id="cb24-15"><a></a>    <span class="at">markdown =</span> T</span>
<span id="cb24-16"><a></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="etable">
<img src="./images/etable/etable_tex_2025-04-08_2540437183.png">
</div>
</div>
<div class="fragment">
<p>Encontramos que los coeficientes han variado al usar una muestra diferente.</p>
</div>
</section><section id="variabilidad-en-los-estimadores-1" class="slide level2"><h2>Variabilidad en los estimadores</h2>
<p>Ahora cuantificaremos la variabilidad de los estimadores de los coeficientes para muchas muestras aleatorias, para entender cómo se distribuyen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a></span>
<span id="cb25-4"><a></a>simular_datos <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb25-5"><a></a>    <span class="fu">tibble</span>(</span>
<span id="cb25-6"><a></a>        <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb25-7"><a></a>        <span class="at">escolaridad =</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">25</span>),</span>
<span id="cb25-8"><a></a>        <span class="at">ingreso =</span> <span class="dv">1000</span> <span class="sc">+</span> (<span class="dv">200</span> <span class="sc">*</span> escolaridad) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb25-9"><a></a>    ) </span>
<span id="cb25-10"><a></a>}</span>
<span id="cb25-11"><a></a></span>
<span id="cb25-12"><a></a></span>
<span id="cb25-13"><a></a>simulaciones <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb25-14"><a></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_sim,</span>
<span id="cb25-15"><a></a>    <span class="at">simulacion =</span> <span class="fu">map</span>(id, simular_datos),</span>
<span id="cb25-16"><a></a>    <span class="at">fit =</span> <span class="fu">map</span>(simulacion, <span class="sc">~</span> <span class="fu">feols</span>(ingreso <span class="sc">~</span> escolaridad, <span class="at">data =</span> .x)),</span>
<span id="cb25-17"><a></a>    <span class="at">coef =</span> <span class="fu">map</span>(fit, coef),</span>
<span id="cb25-18"><a></a>    <span class="at">intercept =</span> <span class="fu">map_dbl</span>(coef, <span class="dv">1</span>),</span>
<span id="cb25-19"><a></a>    <span class="at">escolaridad =</span> <span class="fu">map_dbl</span>(coef, <span class="dv">2</span>)</span>
<span id="cb25-20"><a></a>) <span class="sc">|&gt;</span></span>
<span id="cb25-21"><a></a>    <span class="fu">select</span>(id, intercept, escolaridad) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<img data-src="lecture3_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"><div class="fragment">
<ul>
<li class="fragment">
<p>Los coeficientes de MCO siguen una distribución normal.</p>
<ul>
<li class="fragment">Esto sigue de que su interpretación es <em>promedio</em>.</li>
</ul>
</li>
<li class="fragment">
<p>¡La media de los coeficientes estimados es igual al verdadero valor de los coeficientes!</p>
<ul>
<li class="fragment">Esto es una propiedad de los estimadores de MCO: son <em>insesgados</em>.</li>
<li class="fragment">Esto significa que, en promedio, el estimador de MCO es igual al verdadero valor del parámetro.</li>
</ul>
</li>
<li class="fragment"><p>La inferencia de los coeficientes sigue de la misma manera que una prueba de hipótesis de un promedio.</p></li>
</ul>
</div>
</section><section id="variabilidad-en-los-estimadores-1-output" class="slide level2 output-location-slide"><h2>Variabilidad en los estimadores</h2><div class="cell output-location-slide">

</div></section><section id="inferencia-para-coeficientes-1" class="slide level2"><h2>Inferencia para coeficientes</h2>
<p>Regresemos a la tabla de coeficientes, donde podremos encontrar algunas pruebas de hipótesis ya calculadas.</p>
<div class="etable">
<img src="./images/etable/etable_tex_2025-04-08_1400648435.png">
</div>
<ul>
<li class="fragment"><p>El error estándar de los coeficientes es una medida de la variabilidad de los estimadores, en la misma escala que los coeficientes.</p></li>
<li class="fragment"><p>Si multiplicamos el error estándar por 1.96, obtenemos un intervalo de confianza del 95% para el coeficiente.</p></li>
<li class="fragment"><p>Si el intervalo de confianza no incluye 0, podemos rechazar la hipótesis nula de que el coeficiente es igual a 0.</p></li>
<li class="fragment"><p>Las estrellas indican para qué niveles de significancia podemos rechazar la hipótesis nula de que el coeficiente es igual a 0.</p></li>
<li class="fragment"><p>Adicionalmente, la prueba F es una prueba conjunta de la relevancia del modelo completo. Un valor mayor a 100 indica que el modelo es relevante.</p></li>
</ul>
<div class="fragment">
<p>Nuestros dos modelos, el simulado y el de la ENIGH, tienen un coeficiente de escolaridad significativo al 1% y son modelos relevantes.</p>
</div>
</section></section><section><section id="sesgo-por-variable-omitida" class="title-slide slide level1 center"><h1>Sesgo por variable omitida</h1>

</section><section id="educación-e-ingresos" class="slide level2"><h2>Educación e ingresos</h2>
<p>Queremos estimar el efecto de la escolaridad en los ingresos.</p>
<div class="fragment">
<p>Sin embargo, puede haber una variable <code>habilidad</code> que determina tanto la escolaridad como el ingreso.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="lecture3_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>¿Cómo afectaría la omisión de la variable <code>habilidad</code> a la estimación del modelo de regresión lineal?</p>
</div>
</section><section id="sesgo-por-variable-omitida-1" class="slide level2"><h2>Sesgo por variable omitida</h2>
<p>En la ENIGH no tenemos información sobre la variable <code>habilidad</code>…</p>
<div class="fragment">
<p>¡Pero podemos simularla!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>habilidad_sim <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-2"><a></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb26-3"><a></a>    <span class="at">habilidad =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb26-4"><a></a>    <span class="at">escolaridad =</span> <span class="dv">2</span> <span class="sc">*</span> habilidad <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb26-5"><a></a>    <span class="at">ingreso =</span> <span class="dv">1000</span> <span class="sc">+</span> (<span class="dv">200</span> <span class="sc">*</span> escolaridad) <span class="sc">+</span> (<span class="dv">500</span> <span class="sc">*</span> habilidad) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb26-6"><a></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="etable">
<img src="./images/etable/etable_tex_2025-04-08_2005937803.png">
</div>
<ul>
<li class="fragment"><p>El modelo que omitió la variable <code>habilidad</code> <strong>sobreestimó</strong> el efecto de la escolaridad en el ingreso.</p></li>
<li class="fragment"><p>Esto siempre pasará cuando exista una variable omitida que esté correlacionada con la variable dependiente <strong>y</strong> la variable independiente.</p></li>
</ul>
</div>
</section><section id="sesgo-por-variable-omitida-1-output" class="slide level2 output-location-slide"><h2>Sesgo por variable omitida</h2><div class="cell output-location-slide">

</div></section></section><section><section id="regresión-lineal-múltiple" class="title-slide slide level1 center"><h1>Regresión lineal múltiple</h1>

</section><section id="modelo-de-regresión-lineal-múltiple" class="slide level2"><h2>Modelo de regresión lineal múltiple</h2>
<p>Recordemos que encontramos que las variables <code>sexo</code> y <code>edad</code> también pueden ser determinantes del ingreso y de la escolaridad.</p>
<div class="fragment">
<p>No incluirlas puede sesgar el estimador del rendimiento de la escolaridad.</p>
</div>
<div class="fragment">
<p>Para <em>controlar</em> por estas variables, podemos incluirlas en el modelo de regresión lineal.</p>
</div>
<div class="fragment">
<div class="etable">
<img src="./images/etable/etable_tex_2025-04-07_1563158499.png">
</div>
<ul>
<li class="fragment"><p>Agregar <code>edad</code> y <code>sexo</code> alivia la preocupación de que puedan estar sesgando el estimador del rendimiento de la escolaridad.</p></li>
<li class="fragment">
<p>Sin embargo, cambiará la interpretación de los coeficientes:</p>
<ul>
<li class="fragment"><p>El intercepto en la columna (2), ahora representa el ingreso promedio de una persona sin educación y de edad = 0. Este estimador carece de sentido en este contexto.</p></li>
<li class="fragment"><p>El coeficiente de <code>escolaridad</code> en la columna (2) indica que un año adicional de escolaridad está asociado con un aumento de $655 en el ingreso, <strong>dejando la edad constante</strong>.</p></li>
</ul>
</li>
<li class="fragment">
<p>Sexo es una variable dicotómica.</p>
<ul>
<li class="fragment"><p>El intercepto de la columna (3) representa el ingreso promedio de un hombre sin escolaridad.</p></li>
<li class="fragment"><p>El coeficiente de <code>escolaridad</code> en la columna (3) indica que un año adicional de escolaridad está asociado con un aumento de $586 en el ingreso, <strong>dejando el sexo constante</strong>.</p></li>
<li class="fragment"><p>El coeficiente de <code>sexo</code> indica que, en promedio, las mujeres tienen un ingreso $3,100 menor que los hombres, <strong>dejando la escolaridad constante</strong>.</p></li>
</ul>
</li>
<li class="fragment"><p>Al incluir ambas variables, el coeficiente de <code>escolaridad</code> en la columna (4) indica que un año adicional de escolaridad está asociado con un aumento de $672.6 en el ingreso, <strong>dejando las demás variables constantes</strong>.</p></li>
</ul>
</div>
</section><section id="referencias" class="slide level2 smaller scrollable"><h2>Referencias</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-aguilaresteva" class="csl-entry" role="listitem">
Aguilar Esteva, Arturo. s.&nbsp;f. <span>«Notas de Microeconometría»</span>. <a href="https://bookdown.org/viclzrz/notasmicro/">https://bookdown.org/viclzrz/notasmicro/</a>.
</div>
<div id="ref-world_bank_estimating_2016" class="csl-entry" role="listitem">
World Bank, y Harry Patrinos. 2016. <span>«Estimating the Return to Schooling Using the <span>Mincer</span> Equation»</span>. <em>IZA World of Labor</em>. <a href="https://doi.org/10.15185/izawol.278">https://doi.org/10.15185/izawol.278</a>.
</div>
</div>
</section></section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://estebandegetau.com/Statistical-tools-in-R/">Herramientas estadísticas en R</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../site_libs/revealjs/plugin/search/search.js"></script><script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }
    
        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();
    
          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }
    
        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }
    
      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiado");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copiado");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/estebandegetau\.github\.io\/Statistical-tools-in-R\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>